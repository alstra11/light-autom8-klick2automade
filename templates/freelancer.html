<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Freelancer Flow Coach - Light-Autom8</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #4CAF50 0%, #45a049 100%);
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            overflow: hidden;
        }
        
        .header {
            background: linear-gradient(135deg, #4CAF50 0%, #45a049 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }
        
        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            font-weight: 600;
        }
        
        .header p {
            font-size: 1.1rem;
            opacity: 0.9;
        }
        
        .nav {
            background: rgba(255,255,255,0.1);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 30px;
            text-align: center;
        }

        .nav a {
            color: white;
            text-decoration: none;
            margin: 0 20px;
            padding: 10px 20px;
            border-radius: 25px;
            background: rgba(255,255,255,0.2);
            transition: all 0.3s ease;
            display: inline-block;
            margin-bottom: 10px;
        }

        .nav a:hover {
            background: rgba(255,255,255,0.3);
            transform: translateY(-2px);
        }
        
        .main-content {
            padding: 40px;
        }
        
        .workflow-builder {
            background: #f8f9fa;
            padding: 30px;
            border-radius: 15px;
            margin-bottom: 30px;
            border: 2px solid #e9ecef;
        }
        
        .workflow-builder h3 {
            color: #333;
            margin-bottom: 20px;
            font-size: 1.5rem;
        }
        
        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 20px;
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #333;
        }
        
        input[type="text"], input[type="email"], select, textarea {
            width: 100%;
            padding: 12px;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 16px;
            transition: border-color 0.3s ease;
        }
        
        input[type="text"]:focus, input[type="email"]:focus, select:focus, textarea:focus {
            outline: none;
            border-color: #4CAF50;
        }
        
        textarea {
            height: 100px;
            resize: vertical;
        }
        
        .btn {
            background: linear-gradient(135deg, #4CAF50 0%, #45a049 100%);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: transform 0.2s ease, box-shadow 0.2s ease;
            margin-right: 10px;
            margin-bottom: 10px;
        }
        
        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(76, 175, 80, 0.3);
        }
        
        .btn:active {
            transform: translateY(0);
        }
        
        .btn-secondary {
            background: linear-gradient(135deg, #6c757d 0%, #495057 100%);
        }
        
        .btn-success {
            background: linear-gradient(135deg, #28a745 0%, #20c997 100%);
        }
        
        .btn-warning {
            background: linear-gradient(135deg, #ffc107 0%, #e0a800 100%);
            color: #212529;
        }
        
        .status {
            padding: 15px;
            border-radius: 8px;
            margin-top: 20px;
            font-weight: 600;
            text-align: center;
        }
        
        .status.success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        
        .status.error {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
        
        .workflows-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 30px;
            margin-bottom: 40px;
        }
        
        .workflow-card {
            background: white;
            padding: 25px;
            border-radius: 15px;
            border: 2px solid #f0f0f0;
            box-shadow: 0 5px 15px rgba(0,0,0,0.05);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }
        
        .workflow-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 30px rgba(0,0,0,0.1);
        }
        
        .workflow-card h4 {
            color: #333;
            margin-bottom: 15px;
            font-size: 1.3rem;
        }
        
        .workflow-card p {
            color: #666;
            margin-bottom: 20px;
            line-height: 1.6;
        }
        
        .workflow-actions {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }
        
        .workflow-actions .btn {
            flex: 1;
            min-width: 120px;
        }
        
        .stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .stat-card {
            background: white;
            padding: 25px;
            border-radius: 15px;
            text-align: center;
            border: 2px solid #f0f0f0;
            box-shadow: 0 5px 15px rgba(0,0,0,0.05);
        }
        
        .stat-number {
            font-size: 2.5rem;
            font-weight: bold;
            color: #4CAF50;
            margin-bottom: 5px;
        }
        
        .stat-label {
            color: #666;
            font-size: 0.9rem;
            font-weight: 600;
        }
        
        .json-section {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
            margin-top: 20px;
            border-left: 4px solid #4CAF50;
        }
        
        .json-section h4 {
            color: #333;
            margin-bottom: 15px;
        }
        
        .json-code {
            background: #2d3748;
            color: #e2e8f0;
            padding: 15px;
            border-radius: 8px;
            font-family: 'Courier New', monospace;
            font-size: 14px;
            overflow-x: auto;
            white-space: pre-wrap;
            max-height: 300px;
            overflow-y: auto;
        }
        
        .copy-btn {
            background: #4CAF50;
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 12px;
            margin-top: 10px;
        }
        
        .copy-btn:hover {
            background: #45a049;
        }
        
        .workflow-templates {
            background: #e3f2fd;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
        }
        
        .template-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
            margin-top: 15px;
        }
        
        .template-card {
            background: white;
            padding: 15px;
            border-radius: 8px;
            border: 1px solid #bbdefb;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .template-card:hover {
            background: #f3e5f5;
            transform: translateY(-2px);
        }
        
        .template-card h5 {
            color: #1976d2;
            margin-bottom: 8px;
        }
        
        .template-card p {
            color: #666;
            font-size: 0.9rem;
        }
        
        /* Tools Selection Styles */
        .tools-selection {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
            border: 2px solid #e9ecef;
            margin-top: 10px;
        }
        
        .tool-category {
            margin-bottom: 25px;
        }
        
        .tool-category:last-child {
            margin-bottom: 0;
        }
        
        .tool-category h5 {
            color: #333;
            margin-bottom: 15px;
            font-size: 1.1rem;
            border-bottom: 2px solid #4CAF50;
            padding-bottom: 5px;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .tool-category .info-icon {
            cursor: pointer;
            font-size: 14px;
            color: #4CAF50;
            transition: color 0.3s ease;
            position: relative;
        }
        
        .tool-category .info-icon:hover {
            color: #2e7d32;
        }
        
        .tool-checkboxes {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 10px;
        }
        
        .tool-checkbox {
            display: flex;
            align-items: center;
            padding: 10px;
            background: white;
            border: 2px solid #e9ecef;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            margin: 0;
        }
        
        .tool-checkbox:hover {
            border-color: #4CAF50;
            background: #f0f8f0;
        }
        
        .tool-checkbox input[type="checkbox"] {
            width: auto;
            margin-right: 10px;
            transform: scale(1.2);
        }
        
        .tool-checkbox input[type="checkbox"]:checked + .tool-name {
            color: #4CAF50;
            font-weight: 600;
        }
        
        .tool-checkbox:has(input[type="checkbox"]:checked) {
            border-color: #4CAF50;
            background: #e8f5e8;
        }
        
        .tool-name {
            font-size: 14px;
            color: #333;
            transition: color 0.3s ease;
        }
        
        /* Workflow Tools Display */
        .workflow-tools {
            background: #e8f5e8;
            padding: 8px 12px;
            border-radius: 6px;
            margin: 10px 0;
            font-size: 14px;
            color: #2e7d32;
            border-left: 3px solid #4CAF50;
        }
        
        /* Modal Tooltip Styles */
        .tooltip-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            z-index: 1000;
            justify-content: center;
            align-items: center;
        }

        .tooltip-modal-content {
            background: white;
            padding: 30px;
            border-radius: 15px;
            text-align: center;
            max-width: 400px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.2);
            position: relative;
        }

        .tooltip-modal-content h3 {
            margin-top: 0;
            color: #333;
            font-size: 1.3rem;
            margin-bottom: 20px;
        }

        .tooltip-modal-content p {
            margin: 20px 0;
            line-height: 1.6;
            color: #666;
            font-size: 1rem;
        }
        
        .tooltip-modal-content .btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 12px 30px;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: transform 0.2s ease, box-shadow 0.2s ease;
            margin-top: 10px;
        }
        
        .tooltip-modal-content .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(102, 126, 234, 0.3);
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>🚀 Freelancer Flow Coach</h1>
            <p>Erstelle und verwalte deine Automations-Workflows</p>
            
            <div class="nav">
                <a href="/">📊 Vector Store</a>
                <a href="/docu">📚 Dokumentation</a>
                <a href="/todo">📝 Todo Management</a>
            </div>
        </div>
        
        <div class="main-content">
            <!-- Workflow Builder -->
            <div class="workflow-builder">
                <h3>🛠️ Neuen Workflow erstellen</h3>
                
                <div class="form-row">
                    <div class="form-group">
                        <label for="workflowName">Workflow Name:</label>
                        <input type="text" id="workflowName" placeholder="z.B. E-Mail Follow-Up">
                    </div>
                    <div class="form-group">
                        <label for="workflowType">Workflow Typ:</label>
                        <select id="workflowType">
                            <option value="lead">Lead Management</option>
                            <option value="invoice">Rechnungen</option>
                            <option value="email">E-Mail Marketing</option>
                            <option value="social">Social Media</option>
                            <option value="project">Projekt Management</option>
                            <option value="custom">Custom</option>
                        </select>
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="workflowDescription">Beschreibung:</label>
                    <textarea id="workflowDescription" placeholder="Beschreibe, was dieser Workflow tun soll..."></textarea>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label for="triggerType">Trigger:</label>
                        <select id="triggerType">
                            <option value="webhook">Webhook</option>
                            <option value="schedule">Zeitplan</option>
                            <option value="email">E-Mail</option>
                            <option value="form">Formular</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="actionType">Aktion:</label>
                        <select id="actionType">
                            <option value="email">E-Mail senden</option>
                            <option value="crm">CRM aktualisieren</option>
                            <option value="slack">Slack Nachricht</option>
                            <option value="stripe">Stripe Rechnung</option>
                            <option value="sheets">Google Sheets</option>
                        </select>
                    </div>
                </div>
                
                <!-- Tools Selection -->
                <div class="form-group">
                    <label>Verwendete Tools (wähle alle aus, die du nutzt):</label>
                    <div class="tools-selection">
                        <div class="tool-category">
                            <h5>📊 Office & Produktivität <span class="info-icon" onclick="showTooltip(event, 'office')" title="Welche Programme nutzt du für deine Dokumente und Tabellen?">ℹ️</span></h5>
                            <div class="tool-checkboxes">
                                <label class="tool-checkbox">
                                    <input type="checkbox" value="excel" name="tools">
                                    <span class="tool-name">Microsoft Excel</span>
                                </label>
                                <label class="tool-checkbox">
                                    <input type="checkbox" value="word" name="tools">
                                    <span class="tool-name">Microsoft Word</span>
                                </label>
                                <label class="tool-checkbox">
                                    <input type="checkbox" value="powerpoint" name="tools">
                                    <span class="tool-name">Microsoft PowerPoint</span>
                                </label>
                                <label class="tool-checkbox">
                                    <input type="checkbox" value="docs" name="tools">
                                    <span class="tool-name">Google Docs</span>
                                </label>
                                <label class="tool-checkbox">
                                    <input type="checkbox" value="sheets" name="tools">
                                    <span class="tool-name">Google Sheets</span>
                                </label>
                            </div>
                        </div>
                        
                        <div class="tool-category">
                            <h5>💼 CRM & Sales <span class="info-icon" onclick="showTooltip(event, 'crm')" title="Wie speicherst du deine Kontakte ab?">ℹ️</span></h5>
                            <div class="tool-checkboxes">
                                <label class="tool-checkbox">
                                    <input type="checkbox" value="hubspot" name="tools">
                                    <span class="tool-name">HubSpot</span>
                                </label>
                                <label class="tool-checkbox">
                                    <input type="checkbox" value="salesforce" name="tools">
                                    <span class="tool-name">Salesforce</span>
                                </label>
                                <label class="tool-checkbox">
                                    <input type="checkbox" value="pipedrive" name="tools">
                                    <span class="tool-name">Pipedrive</span>
                                </label>
                                <label class="tool-checkbox">
                                    <input type="checkbox" value="zoho" name="tools">
                                    <span class="tool-name">Zoho CRM</span>
                                </label>
                            </div>
                        </div>
                        
                        <div class="tool-category">
                            <h5>📧 Kommunikation <span class="info-icon" onclick="showTooltip(event, 'communication')" title="Wie nimmst du mit den Kontakten Kontakt auf?">ℹ️</span></h5>
                            <div class="tool-checkboxes">
                                <label class="tool-checkbox">
                                    <input type="checkbox" value="gmail" name="tools">
                                    <span class="tool-name">Gmail</span>
                                </label>
                                <label class="tool-checkbox">
                                    <input type="checkbox" value="outlook" name="tools">
                                    <span class="tool-name">Outlook</span>
                                </label>
                                <label class="tool-checkbox">
                                    <input type="checkbox" value="slack" name="tools">
                                    <span class="tool-name">Slack</span>
                                </label>
                                <label class="tool-checkbox">
                                    <input type="checkbox" value="teams" name="tools">
                                    <span class="tool-name">Microsoft Teams</span>
                                </label>
                            </div>
                        </div>
                        
                        <div class="tool-category">
                            <h5>💰 Finanzen & Zahlungen <span class="info-icon" onclick="showTooltip(event, 'finance')" title="Wie verwaltest du dein Geld? Und wie nimmst du Geld entgegen?">ℹ️</span></h5>
                            <div class="tool-checkboxes">
                                <label class="tool-checkbox">
                                    <input type="checkbox" value="stripe" name="tools">
                                    <span class="tool-name">Stripe</span>
                                </label>
                                <label class="tool-checkbox">
                                    <input type="checkbox" value="paypal" name="tools">
                                    <span class="tool-name">PayPal</span>
                                </label>
                                <label class="tool-checkbox">
                                    <input type="checkbox" value="quickbooks" name="tools">
                                    <span class="tool-name">QuickBooks</span>
                                </label>
                                <label class="tool-checkbox">
                                    <input type="checkbox" value="xero" name="tools">
                                    <span class="tool-name">Xero</span>
                                </label>
                            </div>
                        </div>
                        
                        <div class="tool-category">
                            <h5>📱 Social Media & Marketing <span class="info-icon" onclick="showTooltip(event, 'social')" title="Wo präsentierst du dich und deine Arbeit?">ℹ️</span></h5>
                            <div class="tool-checkboxes">
                                <label class="tool-checkbox">
                                    <input type="checkbox" value="linkedin" name="tools">
                                    <span class="tool-name">LinkedIn</span>
                                </label>
                                <label class="tool-checkbox">
                                    <input type="checkbox" value="twitter" name="tools">
                                    <span class="tool-name">Twitter/X</span>
                                </label>
                                <label class="tool-checkbox">
                                    <input type="checkbox" value="facebook" name="tools">
                                    <span class="tool-name">Facebook</span>
                                </label>
                                <label class="tool-checkbox">
                                    <input type="checkbox" value="instagram" name="tools">
                                    <span class="tool-name">Instagram</span>
                                </label>
                            </div>
                        </div>
                    </div>
                </div>
                
                <button class="btn" onclick="createWorkflow()">
                    🚀 Workflow erstellen
                </button>
                <button class="btn btn-secondary" onclick="loadTemplates()">
                    📋 Templates laden
                </button>
                
                <div id="workflowStatus"></div>
            </div>
            
            <!-- Workflow Templates -->
            <div class="workflow-templates" id="templatesSection" style="display: none;">
                <h4>📋 Workflow Templates</h4>
                <p>Wähle ein Template aus, um schnell zu starten:</p>
                <div class="template-grid" id="templatesGrid">
                    <!-- Templates werden hier dynamisch geladen -->
                </div>
            </div>
            
            <!-- Meine Workflows -->
            <div class="workflows-grid" id="workflowsGrid">
                <!-- Vordefinierte Workflows -->
                <div class="workflow-card">
                    <h4>🎯 Lead Router</h4>
                    <p>Automatisiere deine Lead-Verarbeitung. Eingehende Leads werden automatisch kategorisiert und weitergeleitet.</p>
                    <div class="workflow-actions">
                        <button class="btn" onclick="openWorkflow('lead-router')">Öffnen</button>
                        <button class="btn btn-secondary" onclick="exportWorkflow('lead-router')">Export</button>
                        <button class="btn btn-warning" onclick="testWorkflow('lead-router')">Test</button>
                    </div>
                </div>
                
                <div class="workflow-card">
                    <h4>💰 Invoice Generator</h4>
                    <p>Erstelle automatisch Rechnungen basierend auf deinen Projekten und sende sie an Kunden.</p>
                    <div class="workflow-actions">
                        <button class="btn" onclick="openWorkflow('invoice-generator')">Öffnen</button>
                        <button class="btn btn-secondary" onclick="exportWorkflow('invoice-generator')">Export</button>
                        <button class="btn btn-warning" onclick="testWorkflow('invoice-generator')">Test</button>
                    </div>
                </div>
                
                <div class="workflow-card">
                    <h4>📧 E-Mail Follow-Up</h4>
                    <p>Automatische Follow-Up E-Mails nach Projektabschluss oder Lead-Kontakt.</p>
                    <div class="workflow-actions">
                        <button class="btn" onclick="openWorkflow('email-followup')">Öffnen</button>
                        <button class="btn btn-secondary" onclick="exportWorkflow('email-followup')">Export</button>
                        <button class="btn btn-warning" onclick="testWorkflow('email-followup')">Test</button>
                    </div>
                </div>
                
                <div class="workflow-card">
                    <h4>📊 Projekt Status Updates</h4>
                    <p>Automatische Status-Updates für Kunden über Projektfortschritt.</p>
                    <div class="workflow-actions">
                        <button class="btn" onclick="openWorkflow('project-status')">Öffnen</button>
                        <button class="btn btn-secondary" onclick="exportWorkflow('project-status')">Export</button>
                        <button class="btn btn-warning" onclick="testWorkflow('project-status')">Test</button>
                    </div>
                </div>
            </div>
            
            <!-- Stats Dashboard -->
            <div class="stats">
                <div class="stat-card">
                    <div class="stat-number" id="totalWorkflows">4</div>
                    <div class="stat-label">Aktive Workflows</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="totalExecutions">0</div>
                    <div class="stat-label">Ausführungen heute</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="timeSaved">0h</div>
                    <div class="stat-label">Zeit gespart</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="successRate">100%</div>
                    <div class="stat-label">Erfolgsrate</div>
                </div>
            </div>
            
            <!-- JSON Export Section -->
            <div class="json-section">
                <h4>📋 Workflow JSON Export</h4>
                <p>Kopiere diese JSON für n8n oder make.com Integration:</p>
                
                <div class="json-code" id="workflowJson">
{% raw %}
{
  "name": "Freelancer Lead Router 2025",
  "nodes": [
    {
      "parameters": {},
      "name": "Webhook Trigger",
      "type": "n8n-nodes-base.webhook",
      "typeVersion": 1,
      "position": [250, 300]
    },
    {
      "parameters": {
        "url": "https://api.stripe.com/v1/customers",
        "method": "POST",
        "sendBody": true,
        "bodyParameters": {
          "parameters": [
            {"name": "email", "value": "={{ $json.email }}"},
            {"name": "name", "value": "={{ $json.name }}"}
          ]
        }
      },
      "name": "Create Stripe Customer",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [450, 300]
    }
  ],
  "connections": {
    "Webhook Trigger": {
      "main": [
        [
          {
            "node": "Create Stripe Customer",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "active": true
}
{% endraw %}
                </div>
                <button class="copy-btn" onclick="copyWorkflowJson()">📋 JSON kopieren</button>
            </div>
        </div>
    </div>
    
    <!-- Tooltip Modal -->
    <div id="tooltipModal" class="tooltip-modal">
        <div class="tooltip-modal-content">
            <h3>Erklärung</h3>
            <p id="tooltipText"></p>
            <button class="btn" onclick="closeTooltipModal()">Schließen</button>
        </div>
    </div>

    <script>
        let workflows = [];
        let totalExecutions = 0;
        let timeSaved = 0;

        // Get selected tools from checkboxes
        function getSelectedTools() {
            const checkboxes = document.querySelectorAll('input[name="tools"]:checked');
            return Array.from(checkboxes).map(cb => cb.value);
        }
        
        // Show tooltip modal for tool categories
        function showTooltip(event, category) {
            const tooltips = {
                'office': 'Welche Programme nutzt du für deine Dokumente und Tabellen?',
                'crm': 'Wie speicherst du deine Kontakte ab?',
                'communication': 'Wie nimmst du mit den Kontakten Kontakt auf?',
                'finance': 'Wie verwaltest du dein Geld? Und wie nimmst du Geld entgegen?',
                'social': 'Wo präsentierst du dich und deine Arbeit?'
            };
            
            const tooltip = tooltips[category];
            if (tooltip) {
                // Set tooltip text
                document.getElementById('tooltipText').textContent = tooltip;
                
                // Show modal
                document.getElementById('tooltipModal').style.display = 'flex';
            }
        }
        
        // Close tooltip modal
        function closeTooltipModal() {
            document.getElementById('tooltipModal').style.display = 'none';
        }
        
        // Close modal when clicking outside
        document.addEventListener('click', function(event) {
            const modal = document.getElementById('tooltipModal');
            if (event.target === modal) {
                closeTooltipModal();
            }
        });

        // Workflow Templates
        const workflowTemplates = {
            'lead-management': {
                name: 'Lead Management',
                description: 'Automatische Lead-Verarbeitung und Weiterleitung',
                type: 'lead',
                config: {
                    trigger: 'webhook',
                    actions: ['crm', 'email', 'slack']
                }
            },
            'invoice-automation': {
                name: 'Rechnungs-Automatisierung',
                description: 'Automatische Rechnungserstellung und Versand',
                type: 'invoice',
                config: {
                    trigger: 'schedule',
                    actions: ['stripe', 'email', 'sheets']
                }
            },
            'email-campaigns': {
                name: 'E-Mail Kampagnen',
                description: 'Automatisierte E-Mail-Marketing Kampagnen',
                type: 'email',
                config: {
                    trigger: 'schedule',
                    actions: ['email', 'sheets']
                }
            },
            'social-posting': {
                name: 'Social Media Posting',
                description: 'Automatisierte Social Media Posts',
                type: 'social',
                config: {
                    trigger: 'schedule',
                    actions: ['twitter', 'linkedin', 'facebook']
                }
            },
            'project-tracking': {
                name: 'Projekt Tracking',
                description: 'Automatische Projektstatus-Updates',
                type: 'project',
                config: {
                    trigger: 'webhook',
                    actions: ['slack', 'email', 'sheets']
                }
            }
        };

        async function createWorkflow() {
            const name = document.getElementById('workflowName').value;
            const type = document.getElementById('workflowType').value;
            const description = document.getElementById('workflowDescription').value;
            const trigger = document.getElementById('triggerType').value;
            const action = document.getElementById('actionType').value;
            const statusDiv = document.getElementById('workflowStatus');
            
            // Get selected tools
            const selectedTools = getSelectedTools();
            
            if (!name || !description) {
                statusDiv.innerHTML = '<div class="status error">Bitte Name und Beschreibung eingeben!</div>';
                return;
            }
            
            if (selectedTools.length === 0) {
                statusDiv.innerHTML = '<div class="status error">Bitte wähle mindestens ein Tool aus!</div>';
                return;
            }
            
            statusDiv.innerHTML = '<div class="status" style="background: #fff3cd; color: #856404;">🔄 Workflow wird erstellt...</div>';
            
            try {
                const response = await fetch('/create-workflow', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        name: name,
                        type: type,
                        config: {
                            trigger: trigger,
                            action: action,
                            description: description,
                            tools: selectedTools
                        }
                    })
                });
                
                const data = await response.json();
                
                if (data.success) {
                    workflows.push(data.workflow);
                    addWorkflowToGrid(data.workflow);
                    updateStats();
                    
                    statusDiv.innerHTML = `
                        <div class="status success">
                            ✅ Workflow "${name}" erfolgreich erstellt!<br>
                            🆔 ID: ${data.workflow.id}<br>
                            📊 Status: ${data.workflow.status}
                        </div>
                    `;
                    
                    // Formular zurücksetzen
                    document.getElementById('workflowName').value = '';
                    document.getElementById('workflowDescription').value = '';
                } else {
                    statusDiv.innerHTML = `<div class="status error">❌ Fehler: ${data.error}</div>`;
                }
            } catch (error) {
                statusDiv.innerHTML = '<div class="status error">❌ Fehler beim Erstellen. Bitte erneut versuchen.</div>';
            }
        }
        
        function addWorkflowToGrid(workflow) {
            const workflowsGrid = document.getElementById('workflowsGrid');
            const workflowCard = document.createElement('div');
            workflowCard.className = 'workflow-card';
            
            // Create tools display
            const tools = workflow.config.tools || [];
            const toolsDisplay = tools.length > 0 ? 
                `<div class="workflow-tools">
                    <strong>Tools:</strong> ${tools.map(tool => getToolDisplayName(tool)).join(', ')}
                </div>` : '';
            
            workflowCard.innerHTML = `
                <h4>${workflow.name}</h4>
                <p>${workflow.config.description || 'Keine Beschreibung'}</p>
                ${toolsDisplay}
                <div class="workflow-actions">
                    <button class="btn" onclick="openWorkflow('${workflow.id}')">Öffnen</button>
                    <button class="btn btn-secondary" onclick="exportWorkflow('${workflow.id}')">Export</button>
                    <button class="btn btn-warning" onclick="testWorkflow('${workflow.id}')">Test</button>
                </div>
            `;
            workflowsGrid.appendChild(workflowCard);
        }
        
        // Get display name for tools
        function getToolDisplayName(toolValue) {
            const toolNames = {
                'excel': 'Excel',
                'word': 'Word',
                'powerpoint': 'PowerPoint',
                'docs': 'Google Docs',
                'sheets': 'Google Sheets',
                'hubspot': 'HubSpot',
                'salesforce': 'Salesforce',
                'pipedrive': 'Pipedrive',
                'zoho': 'Zoho CRM',
                'gmail': 'Gmail',
                'outlook': 'Outlook',
                'slack': 'Slack',
                'teams': 'Teams',
                'stripe': 'Stripe',
                'paypal': 'PayPal',
                'quickbooks': 'QuickBooks',
                'xero': 'Xero',
                'linkedin': 'LinkedIn',
                'twitter': 'Twitter/X',
                'facebook': 'Facebook',
                'instagram': 'Instagram'
            };
            return toolNames[toolValue] || toolValue;
        }
        
        function loadTemplates() {
            const templatesSection = document.getElementById('templatesSection');
            const templatesGrid = document.getElementById('templatesGrid');
            
            if (templatesSection.style.display === 'none') {
                templatesSection.style.display = 'block';
                
                templatesGrid.innerHTML = '';
                Object.keys(workflowTemplates).forEach(key => {
                    const template = workflowTemplates[key];
                    const templateCard = document.createElement('div');
                    templateCard.className = 'template-card';
                    templateCard.onclick = () => useTemplate(key);
                    templateCard.innerHTML = `
                        <h5>${template.name}</h5>
                        <p>${template.description}</p>
                    `;
                    templatesGrid.appendChild(templateCard);
                });
            } else {
                templatesSection.style.display = 'none';
            }
        }
        
        function useTemplate(templateKey) {
            const template = workflowTemplates[templateKey];
            document.getElementById('workflowName').value = template.name;
            document.getElementById('workflowType').value = template.type;
            document.getElementById('workflowDescription').value = template.description;
            document.getElementById('triggerType').value = template.config.trigger;
            document.getElementById('actionType').value = template.config.actions[0];
            
            // Verstecke Templates wieder
            document.getElementById('templatesSection').style.display = 'none';
        }
        
        function openWorkflow(workflowId) {
            alert(`Workflow ${workflowId} wird geöffnet...`);
            // Hier würde der Workflow-Editor geöffnet werden
        }
        
        function exportWorkflow(workflowId) {
            // Hier würde die JSON für den spezifischen Workflow generiert werden
            alert(`Workflow ${workflowId} wird exportiert...`);
        }
        
        function testWorkflow(workflowId) {
            totalExecutions++;
            timeSaved += 2; // 2 Stunden pro Test gespart
            updateStats();
            alert(`Workflow ${workflowId} wird getestet...`);
        }
        
        function updateStats() {
            document.getElementById('totalWorkflows').textContent = 4 + workflows.length;
            document.getElementById('totalExecutions').textContent = totalExecutions;
            document.getElementById('timeSaved').textContent = timeSaved + 'h';
        }
        
        function copyWorkflowJson() {
            const jsonText = document.getElementById('workflowJson').textContent;
            navigator.clipboard.writeText(jsonText).then(() => {
                alert('JSON in Zwischenablage kopiert!');
            });
        }
    </script>
</body>
</html>
